/* ==========================================================================
   GOOGLE AI STUDIO DARK THEME (Deep Dark, Pill Shapes, Gemini Blue)
   ========================================================================== */
@import url('https://fonts.googleapis.com/css2?family=Google+Sans+Code:ital,wght@0,300..800;1,300..800&display=swap');

body {
    /* --- AI Studio Palette --- */
    --background-primary: #191919;   /* Deepest Dark (AI Studio Background) */
    --background-secondary: #1e1f20; /* Surfaces / Sidebar */
    --background-secondary-alt: #000000; /* Top header blend */
    --background-modifier-border: #444746; /* Subtle borders */
    
    /* --- Typography --- */
    --font-interface: 'Google Sans', 'Roboto', 'Inter', sans-serif;
    --font-text: 'Google Sans', 'Roboto', 'Inter', sans-serif;
    
    /* Заголовки */
    --h1-color: #e3e3e3;
    --h2-color: #e3e3e3;
    --h3-color: #c4c7c5;
    --h4-color: #c4c7c5;
    
    /* Текст */
    --text-normal: #c4c7c5;          /* Google Neutral 200 */
    --text-muted: #8e918f;           /* Google Neutral 500 */
    --text-faint: #444746;           
    
    /* Gemini Accents */
    --text-accent: #A8C7FA;          /* Google Blue 200 (Gemini Blue) */
    --text-accent-hover: #D3E3FD;
    --interactive-accent: #3b5260;   /* Deep Blue for backgrounds */
    --caret-color: #A8C7FA; 

    /* --- Sizes --- */
    --h1-size: 2.2em; --h1-weight: 400;
    --h2-size: 1.6em; --h2-weight: 400;
    --h3-size: 1.2em; --h3-weight: 500;
    
    /* --- Coding --- */
    --code-background: #1e1f20;      /* Matching surface color */
    --code-border-color: #444746;
    --font-family-code: 'Google Sans Code',  monospace;
    --code-size: 0.9em;
    
    /* Syntax Highlighting (Pastel/Vivid mix) */
    --code-normal: #e3e3e3;
    --code-comment: #8e918f;
    --code-string: #f28b82;          /* Pastel Red */
    --code-function: #A8C7FA;        /* Pastel Blue */
    --code-keyword: #c58af9;         /* Pastel Purple */
    --code-operator: #c4c7c5;
    --code-property: #81c995;        /* Pastel Green */
    --code-value: #fdd663;           /* Pastel Yellow */
    
    /* Shapes */
    --radius-s: 4px;
    --radius-m: 12px;                /* More rounded */
    --radius-l: 24px;                /* Full pill shape */
}

/* ==========================================================================
   1. LAYOUT & TYPOGRAPHY
   ========================================================================== */

/* Шрифт везде */
.markdown-source-view, .markdown-preview-view, .nav-file-title, .nav-folder-title {
    font-family: var(--font-interface);
}

/* Ограничение ширины (Focus) */
.markdown-source-view .cm-scroller,
.markdown-preview-view { 
    max-width: 1400px !important; /* Чуть уже для AI-style */
    margin: 0 auto !important; 
    width: 100%;
}

/* Текст редактора */
.markdown-source-view, 
.markdown-preview-view { 
    line-height: 1.7; /* Больше воздуха */
    font-size: 16px;
    color: var(--text-normal); 
}

/* Приглушение обычного текста */
.cm-line, p, li {
    color: var(--text-normal) !important;
}

/* Заголовки */
.cm-header, h1, h2, h3 {
    color: var(--h1-color) !important;
    letter-spacing: normal;
    margin-top: 2em !important;
    margin-bottom: 1em !important;
}

/* ==========================================================================
   2. HEADER & TABS (MINIMALIST)
   ========================================================================== */

/* Верхняя панель сливается с темным фоном */
.titlebar {
    background-color: transparent !important;
    z-index: 0; /* На всякий случай опускаем уровень */
}

.workspace-tab-header-container {
    background-color: var(--background-primary) !important; /* Цвет фона */
    border-bottom: 1px solid var(--background-modifier-border);
    /* padding-top: 5px; */
}

.titlebar-button-container {
    background-color: var(--background-primary) !important; 
}


/* Вкладки - Минималистичный текст */
.workspace-tab-header {
    background-color: transparent !important;
    color: var(--text-muted);
    border-radius: var(--radius-m) var(--radius-m) 0 0;
    margin-right: 4px;
    /* transition: all 0.1s ease; */
}

/* Активная вкладка - Подчеркивание Gemini */
.workspace-tab-header.is-active {
    background-color: var(--background-primary) !important; 
    /* color: var(--text-accent) !important; */
    font-weight: 500;
    box-shadow: none !important;
    border-top: 1px solid var(--text-faint); 
    border-left: 1px solid var(--text-faint); 
    border-right: 1px solid var(--text-faint); 
}

.workspace-tab-header:not(.is-active):hover {
    color: var(--text-normal);
    background-color: rgba(255,255,255, 0.03) !important;
}

.titlebar-button:hover {
    background-color: rgba(255,255,255, 0.08) !important;
}

/* ==========================================================================
   FIX: LEFT RIBBON & SIDEBAR (SEAMLESS LOOK)
   ========================================================================== */

/* 1. Сама узкая полоска с иконками слева */
/* .workspace-ribbon {
    background-color: var(--background-primary) !important; 
    border-right: 1px solid var(--background-modifier-border) !important; 
} */

/* 2. Кнопка переключения сайдбара (верхняя левая иконка "папка со стрелкой") */
.sidebar-toggle-button {
    background-color: var(--background-primary) !important; /* Убираем фон кнопки, чтобы она слилась */
    border: none !important;
    padding-top: 10px; /* Чуть выравниваем, если нужно */
}

/* При наведении на иконку в углу */
.sidebar-toggle-button:hover {
    background-color: var(--background-primary-hover) !important;
}

/* 3. Левая панель, где список файлов (чтобы она тоже совпадала по цвету) */
.workspace-split.mod-left-split {
    background-color: var(--background-primary) !important;
}

/* Иконки в риббоне (Graph view, Settings и т.д.) */
.workspace-ribbon-collapse-btn, 
.side-dock-ribbon-action {
    color: var(--text-muted) !important;
}
.side-dock-ribbon-action:hover {
    color: var(--text-normal) !important;
    background-color: rgba(255, 255, 255, 0.08);
}

/* ==========================================================================
   3. SIDEBAR (PILL SHAPED NAVIGATION)
   ========================================================================== */

/* Контейнер */
.nav-folder-title, .nav-file-title {
    font-size: 0.95em;
    color: var(--text-muted);
    /* Полная пилюля (Pill shape) */
    border-radius: var(--radius-l); 
    padding: 6px 12px;
    margin: 2px 8px; /* Отступы со всех сторон */
    /* transition: all 0.2s ease; */
}

/* Hover */
.nav-file-title:hover, .nav-folder-title:hover {
    color: var(--text-normal);
    background-color: rgba(168, 199, 250, 0.08); /* Слабый голубой ховер */
}

/* Активный файл - Плавающая пилюля */
.nav-file-title.is-active {
    /* background-color: var(--interactive-accent);  */
    color: var(--text-accent) !important; 
    font-weight: 500;
}

/* Иконки */
body:not(.remove-file-icons) .nav-file-title .nav-file-title-content:not(.mk-tree-text)::before {
    content: "";
    display: inline-block;
    width: 14px; height: 14px;
    margin-right: 10px;
    background-color: var(--text-muted);
    -webkit-mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>') no-repeat center;
    -webkit-mask-size: contain;
    opacity: 0.7;
}
.nav-file-title.is-active .nav-file-title-content::before {
    background-color: var(--text-accent);
    opacity: 1;
}

/* ==========================================================================
   4. LISTS & CHECKBOXES (BUG FREE)
   ========================================================================== */

/* Fix списка в режиме редактирования */
.markdown-source-view.is-live-preview .HyperMD-list-line {
    padding-bottom: 0.7em !important;
    margin-bottom: 0 !important;
}
.markdown-preview-view li {
    margin-bottom: 0.7em !important;
}

/* Чекбоксы - Круглые, тонкие */
input[type=checkbox] {
    -webkit-appearance: none;
    appearance: none;
    border-radius: 50%;
    border: 1.5px solid var(--text-muted);
    width: 18px;
    height: 18px;
    position: relative;
    top: 4px;
    cursor: pointer;
    background-color: transparent;
}
input[type=checkbox]:checked {
    background-color: var(--text-accent);
    border-color: var(--text-accent);
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23131314'%3E%3Cpath d='M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z'/%3E%3C/svg%3E");
}

/* ==========================================================================
   5. CODE & CARDS (AI STUDIO STYLE)
   ========================================================================== */

/* Цитаты - Мягкие блоки */
blockquote {
    border: none;
    background-color: #1e1f20;
    border-radius: var(--radius-m);
    padding: 16px 24px;
    margin: 1.5em 0;
    color: var(--text-normal);
    font-style: normal; /* В AI Studio обычный шрифт */
    border-left: 4px solid var(--text-accent);
}

/* Инлайн код - Пилюли */
.markdown-source-view.is-live-preview .cm-inline-code,
.markdown-reading-view code {
    color: var(--text-accent) !important;
    background-color: #1e1f20;
    border: 1px solid #333;
    padding: 2px 5px;
    /* border-radius: 10px;  */
    font-family: var(--font-family-code);
    /* font-size: 0.85em; */
}

/* Блоки кода */
.markdown-reading-view pre,
.markdown-source-view.is-live-preview .HyperMD-codeblock {
    background-color: var(--code-background);
    font-family: var(--font-family-code);
}

.markdown-reading-view pre {
    border: 1px solid var(--background-modifier-border);
    border-radius: var(--radius-m);
    padding: 20px;
}

/* Скругления в редакторе */
.markdown-source-view.is-live-preview .HyperMD-codeblock-begin {
    border-top: 1px solid var(--background-modifier-border);
    border-left: 1px solid var(--background-modifier-border);
    border-right: 1px solid var(--background-modifier-border);
    border-top-left-radius: var(--radius-m);
    border-top-right-radius: var(--radius-m);
    padding-top: 5px;
    background-color: var(--code-background);
}
.markdown-source-view.is-live-preview .HyperMD-codeblock {
    border-left: 1px solid var(--background-modifier-border);
    border-right: 1px solid var(--background-modifier-border);
}
.markdown-source-view.is-live-preview .HyperMD-codeblock-end {
    border-bottom: 1px solid var(--background-modifier-border);
    border-left: 1px solid var(--background-modifier-border);
    border-right: 1px solid var(--background-modifier-border);
    border-bottom-left-radius: var(--radius-m);
    border-bottom-right-radius: var(--radius-m);
    padding-bottom: 5px;
    background-color: var(--code-background);
}

/* Подсветка (Принудительная) */
.cm-s-obsidian span.cm-comment { color: var(--code-comment) !important; }
.cm-s-obsidian span.cm-string { color: var(--code-string) !important; }
.cm-s-obsidian span.cm-keyword { color: var(--code-keyword) !important; }
.cm-s-obsidian span.cm-def { color: var(--code-function) !important; }
.cm-s-obsidian span.cm-property { color: var(--code-property) !important; }
.cm-s-obsidian span.cm-number { color: var(--code-value) !important; }

/* Скроллбар (Минимализм) */
::-webkit-scrollbar { width: 10px; height: 10px; background: transparent; }
::-webkit-scrollbar-thumb { background: #444746; border-radius: 10px; border: 3px solid var(--background-primary); }
::-webkit-scrollbar-thumb:hover { background: #5f6368; }
